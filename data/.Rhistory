pols<-read.csv("politics.csv")
pols<-read.csv("politics.csv")
pols<-read.csv("politics.csv")
pols<-read.csv("politics.csv")
setwd("~/College/Spring2015/PSY 441 Projects in Experimental Psychology/Reproducibility")
pols<-read.csv("politics.csv")
setwd("~/College/Spring2015/PSY 441 Projects in Experimental Psychology/Reproducibility/data")
pols<-read.csv("politics.csv")
summary(aov(optimismscore~party*sex,data=pols[pols$testtime=="post",]))
summary(aov(income~party*sex,data=pols[pols$testtime=="pre",]))
summary(aov(optimismscore~party*sex,data=pols[pols$testtime=="post",]))
temp<-pols[pols$testtime=="pre",]%>%group_by(party,sex)%>%
summarize(means=mean(income),sems=sd(income)/sqrt(length(income)))
library("gplots")
col1=col2hex("deeppink")
col2=col2hex("deepskyblue2")
f<-ggplot(temp, aes(x=party, y=means, fill=sex))+
geom_bar(stat="identity",position=position_dodge())+
scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))+
theme(legend.key=element_rect(color="black"))+
geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))+
ggtitle("Incomes by Sex and Political Affiliation")+
labs(x="Political Party Affiliation",y="Income\n(thousands of dollars)")+
scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))+
theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))+
theme(panel.border=element_blank(),axis.line=element_line())+
theme(panel.grid.major.x=element_blank())+
theme(panel.grid.major.y=element_line(color="darkgrey"))+
theme(panel.grid.minor.y=element_blank())+
theme(legend.position=c(.2,.76))+
theme(legend.background=element_blank())+
theme(legend.background=element_rect(color="black"))+
theme(legend.title=element_blank())+
theme(legend.title=element_text(size=12))+
theme(legend.title.align=.5)+
theme(legend.text=element_text(size=10,face="bold"))
f
temp<-pols[pols$testtime=="pre",]%>%group_by(party,sex)%>%summarize(means=mean(income),sems=sd(income)/sqrt(length(income)))
library("dplyr")
temp<-pols[pols$testtime=="pre",]%>%group_by(party,sex)%>%summarize(means=mean(income),sems=sd(income)/sqrt(length(income)))
library("gplots")
col1=col2hex("deeppink")
col2=col2hex("deepskyblue2")
f<-ggplot(temp, aes(x=party, y=means, fill=sex))+
geom_bar(stat="identity",position=position_dodge())+
scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))+
theme(legend.key=element_rect(color="black"))+
geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))+
ggtitle("Incomes by Sex and Political Affiliation")+
labs(x="Political Party Affiliation",y="Income\n(thousands of dollars)")+
scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))+
theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))+
theme(panel.border=element_blank(),axis.line=element_line())+
theme(panel.grid.major.x=element_blank())+
theme(panel.grid.major.y=element_line(color="darkgrey"))+
theme(panel.grid.minor.y=element_blank())+
theme(legend.position=c(.2,.76))+
theme(legend.background=element_blank())+
theme(legend.background=element_rect(color="black"))+
theme(legend.title=element_blank())+
theme(legend.title=element_text(size=12))+
theme(legend.title.align=.5)+
theme(legend.text=element_text(size=10,face="bold"))
f
f<-ggplot(temp, aes(x=party, y=means, fill=sex))geom_bar(stat="identity",position=position_dodge())scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))theme(legend.key=element_rect(color="black"))geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))ggtitle("Incomes by Sex and Political Affiliation")labs(x="Political Party Affiliation",y="Income\n(thousands of dollars)")scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))theme(plot.title=element_text(size=15,face="bold",vjust=.5))theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))theme(axis.title.y=element_text(size=12,face="bold",vjust=1))theme(axis.text.x=element_text(size=10,face="bold",color="black"))theme(axis.text.y=element_text(size=10,face="bold",color="black"))coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))theme(panel.border=element_blank(),axis.line=element_line())theme(panel.grid.major.x=element_blank())theme(panel.grid.major.y=element_line(color="darkgrey"))theme(panel.grid.minor.y=element_blank())theme(legend.position=c(.2,.76)theme(legend.background=element_blank())theme(legend.background=element_rect(color="black"))theme(legend.title=element_blank())theme(legend.title=element_text(size=12))theme(legend.title.align=.5)theme(legend.text=element_text(size=10,face="bold"))f
f<-ggplot(temp, aes(x=party, y=means, fill=sex))geom_bar(stat="identity",position=position_dodge())scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))theme(legend.key=element_rect(color="black"))geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))ggtitle("Incomes by Sex and Political Affiliation")labs(x="Political Party Affiliation",y="Income\n(thousands of dollars)")scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))theme(plot.title=element_text(size=15,face="bold",vjust=.5))theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))theme(axis.title.y=element_text(size=12,face="bold",vjust=1))theme(axis.text.x=element_text(size=10,face="bold",color="black"))theme(axis.text.y=element_text(size=10,face="bold",color="black"))coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))theme(panel.border=element_blank(),axis.line=element_line())theme(panel.grid.major.x=element_blank())theme(panel.grid.major.y=element_line(color="darkgrey"))theme(panel.grid.minor.y=element_blank())theme(legend.position=c(.2,.76)theme(legend.background=element_blank())theme(legend.background=element_rect(color="black"))theme(legend.title=element_blank())theme(legend.title=element_text(size=12))theme(legend.title.align=.5)theme(legend.text=element_text(size=10,face="bold"))f
f<-ggplot(temp, aes(x=party, y=means, fill=sex)) geom_bar(stat="identity",position=position_dodge())scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))theme(legend.key=element_rect(color="black"))geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))ggtitle("Incomes by Sex and Political Affiliation")labs(x="Political Party Affiliation",y="Income\n(thousands of dollars)")scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))theme(plot.title=element_text(size=15,face="bold",vjust=.5))theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))theme(axis.title.y=element_text(size=12,face="bold",vjust=1))theme(axis.text.x=element_text(size=10,face="bold",color="black"))theme(axis.text.y=element_text(size=10,face="bold",color="black"))coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))theme(panel.border=element_blank(),axis.line=element_line())theme(panel.grid.major.x=element_blank())theme(panel.grid.major.y=element_line(color="darkgrey"))theme(panel.grid.minor.y=element_blank())theme(legend.position=c(.2,.76)theme(legend.background=element_blank())theme(legend.background=element_rect(color="black"))theme(legend.title=element_blank())theme(legend.title=element_text(size=12))theme(legend.title.align=.5)theme(legend.text=element_text(size=10,face="bold"))f
col1=col2hex("deeppink")
col2=col2hex("deepskyblue2")
f<-ggplot(temp, aes(x=party, y=means, fill=sex)) geom_bar(stat="identity",position=position_dodge())scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))theme(legend.key=element_rect(color="black"))geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))ggtitle("Incomes by Sex and Political Affiliation")labs(x="Political Party Affiliation",y="Income\n(thousands of dollars)")scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))theme(plot.title=element_text(size=15,face="bold",vjust=.5))theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))theme(axis.title.y=element_text(size=12,face="bold",vjust=1))theme(axis.text.x=element_text(size=10,face="bold",color="black"))theme(axis.text.y=element_text(size=10,face="bold",color="black"))coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))theme(panel.border=element_blank(),axis.line=element_line())theme(panel.grid.major.x=element_blank())theme(panel.grid.major.y=element_line(color="darkgrey"))theme(panel.grid.minor.y=element_blank())theme(legend.position=c(.2,.76)theme(legend.background=element_blank())theme(legend.background=element_rect(color="black"))theme(legend.title=element_blank())theme(legend.title=element_text(size=12))theme(legend.title.align=.5)theme(legend.text=element_text(size=10,face="bold"))f
fig<-ggplot(temp, aes(x=party, y=means, fill=sex)) geom_bar(stat="identity",position=position_dodge())scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))theme(legend.key=element_rect(color="black"))geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))ggtitle("Incomes by Sex and Political Affiliation")labs(x="Political Party Affiliation",y="Income\n(thousands of dollars)")scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))theme(plot.title=element_text(size=15,face="bold",vjust=.5))theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))theme(axis.title.y=element_text(size=12,face="bold",vjust=1))theme(axis.text.x=element_text(size=10,face="bold",color="black"))theme(axis.text.y=element_text(size=10,face="bold",color="black"))coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))theme(panel.border=element_blank(),axis.line=element_line())theme(panel.grid.major.x=element_blank())theme(panel.grid.major.y=element_line(color="darkgrey"))theme(panel.grid.minor.y=element_blank())theme(legend.position=c(.2,.76)theme(legend.background=element_blank())theme(legend.background=element_rect(color="black"))theme(legend.title=element_blank())theme(legend.title=element_text(size=12))theme(legend.title.align=.5)theme(legend.text=element_text(size=10,face="bold"))
f<-ggplot(temp, aes(x=party, y=means, fill=sex))
f<-gplot(temp, aes(x=party, y=means, fill=sex)) geom_bar(stat="identity",position=position_dodge())scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))theme(legend.key=element_rect(color="black"))geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))ggtitle("Incomes by Sex and Political Affiliation")labs(x="Political Party Affiliation",y="Income\n(thousands of dollars)")scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))theme(plot.title=element_text(size=15,face="bold",vjust=.5))theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))theme(axis.title.y=element_text(size=12,face="bold",vjust=1))theme(axis.text.x=element_text(size=10,face="bold",color="black"))theme(axis.text.y=element_text(size=10,face="bold",color="black"))coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))theme(panel.border=element_blank(),axis.line=element_line())theme(panel.grid.major.x=element_blank())theme(panel.grid.major.y=element_line(color="darkgrey"))theme(panel.grid.minor.y=element_blank())theme(legend.position=c(.2,.76)theme(legend.background=element_blank())theme(legend.background=element_rect(color="black"))theme(legend.title=element_blank())theme(legend.title=element_text(size=12))theme(legend.title.align=.5)theme(legend.text=element_text(size=10,face="bold"))f
f<-gplot(temp, aes(x=party, y=means, fill=sex))
library("gplots")
f<-gplot(temp, aes(x=party, y=means, fill=sex))
f<-ggplot(temp, aes(x=party, y=means, fill=sex))
install.packages("gplots")
install.packages("gplots")
install.packages("gplots")
install.packages("ggplot2")
install.packages("dplyr")
library("gplots")
f<-ggplot(temp, aes(x=party, y=means, fill=sex))
library("ggplot2")
f<-ggplot(temp, aes(x=party, y=means, fill=sex))
f<-ggplot(temp, aes(x=party, y=means, fill=sex))+
geom_bar(stat="identity",position=position_dodge())+
scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))+
theme(legend.key=element_rect(color="black"))+
geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))+
ggtitle("Incomes by Sex and Political Affiliation")+
labs(x="Political Party Affiliation",y="Income\n(thousands of dollars)")+
scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))+
theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))+
theme(panel.border=element_blank(),axis.line=element_line())+
theme(panel.grid.major.x=element_blank())+
theme(panel.grid.major.y=element_line(color="darkgrey"))+
theme(panel.grid.minor.y=element_blank())+
theme(legend.position=c(.2,.76))+
theme(legend.background=element_blank())+
theme(legend.background=element_rect(color="black"))+
theme(legend.title=element_blank())+
theme(legend.title=element_text(size=12))+
theme(legend.title.align=.5)+
theme(legend.text=element_text(size=10,face="bold"))
f
f<-ggplot(temp, aes(x=party, y=means, fill=sex))+
geom_bar(stat="identity",position=position_dodge())+
scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))+
theme(legend.key=element_rect(color="black"))+
geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))+
ggtitle("Optimism Scores by Sex and Political Affiliation")+
labs(x="Political Party Affiliation",y="Optimism\n(Higher Value=Greater Optimism)")+
scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))+
theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))+
theme(panel.border=element_blank(),axis.line=element_line())+
theme(panel.grid.major.x=element_blank())+
theme(panel.grid.major.y=element_line(color="darkgrey"))+
theme(panel.grid.minor.y=element_blank())+
theme(legend.position=c(.2,.76))+
theme(legend.background=element_blank())+
theme(legend.background=element_rect(color="black"))+
theme(legend.title=element_blank())+
theme(legend.title=element_text(size=12))+
theme(legend.title.align=.5)+
theme(legend.text=element_text(size=10,face="bold"))
f
summary(aov(optimismscore~party*sex,data=pols[pols$testtime=="post",]))
temp<-pols[pols$testtime=="pre",]%>%group_by(party,sex)%>%
summarize(means=mean(optimismscore),sems=sd(optimismscore)/sqrt(length(optimismscore)))
library("dplyr")
library("ggplot2")
library("gplots")
temp<-pols[pols$testtime=="pre",]%>%group_by(party,sex)%>%
summarize(means=mean(income),sems=sd(income)/sqrt(length(income)))
col1=col2hex("deeppink")
col2=col2hex("deepskyblue2")
f<-ggplot(temp, aes(x=party, y=means, fill=sex))+
geom_bar(stat="identity",position=position_dodge())+
scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))+
theme(legend.key=element_rect(color="black"))+
geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))+
ggtitle("Incomes by Sex and Political Affiliation")+
labs(x="Political Party Affiliation",y="Income\n(thousands of dollars)")+
scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))+
theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))+
theme(panel.border=element_blank(),axis.line=element_line())+
theme(panel.grid.major.x=element_blank())+
theme(panel.grid.major.y=element_line(color="darkgrey"))+
theme(panel.grid.minor.y=element_blank())+
theme(legend.position=c(.2,.76))+
theme(legend.background=element_blank())+
theme(legend.background=element_rect(color="black"))+
theme(legend.title=element_blank())+
theme(legend.title=element_text(size=12))+
theme(legend.title.align=.5)+
theme(legend.text=element_text(size=10,face="bold"))
f
temp<-pols[pols$testtime=="pre",]%>%group_by(party,sex)%>%
summarize(means=mean(optimismscore),sems=sd(optimismscore)/sqrt(length(optimismscore)))
f<-ggplot(temp, aes(x=party, y=means, fill=sex))+
geom_bar(stat="identity",position=position_dodge())+
scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))+
theme(legend.key=element_rect(color="black"))+
geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))+
ggtitle("Optimism Scores by Sex and Political Affiliation")+
labs(x="Political Party Affiliation",y="Optimism\n(Higher Value=Greater Optimism)")+
scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))+
theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))+
theme(panel.border=element_blank(),axis.line=element_line())+
theme(panel.grid.major.x=element_blank())+
theme(panel.grid.major.y=element_line(color="darkgrey"))+
theme(panel.grid.minor.y=element_blank())+
theme(legend.position=c(.2,.76))+
theme(legend.background=element_blank())+
theme(legend.background=element_rect(color="black"))+
theme(legend.title=element_blank())+
theme(legend.title=element_text(size=12))+
theme(legend.title.align=.5)+
theme(legend.text=element_text(size=10,face="bold"))
f
summary(aov(optimismscore~party*sex,data=pols[pols$testtime=="post",]))
temp<-pols[pols$testtime=="post",]%>%group_by(party,sex)%>%
summarize(means=mean(optimismscore),sems=sd(optimismscore)/sqrt(length(optimismscore)))
library("gplots")
library("ggplot2")
col1=col2hex("deeppink")
col2=col2hex("deepskyblue2")
f<-ggplot(temp, aes(x=party, y=means, fill=sex))+
geom_bar(stat="identity",position=position_dodge())+
scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))+
theme(legend.key=element_rect(color="black"))+
geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))+
ggtitle("Optimism Scores by Sex and Political Affiliation")+
labs(x="Political Party Affiliation",y="Optimism\n(Higher Value=Greater Optimism)")+
scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))+
theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))+
theme(panel.border=element_blank(),axis.line=element_line())+
theme(panel.grid.major.x=element_blank())+
theme(panel.grid.major.y=element_line(color="darkgrey"))+
theme(panel.grid.minor.y=element_blank())+
theme(legend.position=c(.2,.76))+
theme(legend.background=element_blank())+
theme(legend.background=element_rect(color="black"))+
theme(legend.title=element_blank())+
theme(legend.title=element_text(size=12))+
theme(legend.title.align=.5)+
theme(legend.text=element_text(size=10,face="bold"))
f
f<-ggplot(temp, aes(x=party, y=means, fill=sex))+
geom_bar(stat="identity",position=position_dodge())+
scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))+
theme(legend.key=element_rect(color="black"))+
geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))+
ggtitle("Optimism Scores by Sex and Political Affiliation")+
labs(x="Political Party Affiliation",y="Post-Test Optimism\n(Higher Value=Greater Optimism)")+
scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))+
theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))+
theme(panel.border=element_blank(),axis.line=element_line())+
theme(panel.grid.major.x=element_blank())+
theme(panel.grid.major.y=element_line(color="darkgrey"))+
theme(panel.grid.minor.y=element_blank())+
theme(legend.position=c(.2,.76))+
theme(legend.background=element_blank())+
theme(legend.background=element_rect(color="black"))+
theme(legend.title=element_blank())+
theme(legend.title=element_text(size=12))+
theme(legend.title.align=.5)+
theme(legend.text=element_text(size=10,face="bold"))
f
f<-ggplot(temp, aes(x=party, y=means, fill=sex))+
geom_bar(stat="identity",position=position_dodge())+
scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))+
theme(legend.key=element_rect(color="black"))+
geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))+
ggtitle("Post-Test Optimism Scores by Sex and Political Affiliation")+
labs(x="Political Party Affiliation",y="Post-Test Optimism\n(Higher Value=Greater Optimism)")+
scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))+
theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))+
theme(panel.border=element_blank(),axis.line=element_line())+
theme(panel.grid.major.x=element_blank())+
theme(panel.grid.major.y=element_line(color="darkgrey"))+
theme(panel.grid.minor.y=element_blank())+
theme(legend.position=c(.2,.76))+
theme(legend.background=element_blank())+
theme(legend.background=element_rect(color="black"))+
theme(legend.title=element_blank())+
theme(legend.title=element_text(size=12))+
theme(legend.title.align=.5)+
theme(legend.text=element_text(size=10,face="bold"))
f
summary(aov(income~party*sex,data=pols[pols$testtime=="pre",]))
summary(aov(optimismscore~party*sex,data=pols[pols$testtime=="post",]))
temp<-pols[pols$testtime=="post",]%>%group_by(party,sex)%>%
summarize(means=mean(optimismscore),sems=sd(optimismscore)/sqrt(length(optimismscore)))
library("gplots")
library("ggplot2")
col1=col2hex("deeppink")
col2=col2hex("deepskyblue2")
f<-ggplot(temp, aes(x=party, y=means, fill=sex))+
geom_bar(stat="identity",position=position_dodge())+
scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))+
theme(legend.key=element_rect(color="black"))+
geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))+
ggtitle("Post-Test Optimism Scores by Sex and Political Affiliation")+
labs(x="Political Party Affiliation",y="Post-Test Optimism\n(Higher Value=Greater Optimism)")+
scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))+
theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))+
theme(panel.border=element_blank(),axis.line=element_line())+
theme(panel.grid.major.x=element_blank())+
theme(panel.grid.major.y=element_line(color="darkgrey"))+
theme(panel.grid.minor.y=element_blank())+
theme(legend.position=c(.2,.76))+
theme(legend.background=element_blank())+
theme(legend.background=element_rect(color="black"))+
theme(legend.title=element_blank())+
theme(legend.title=element_text(size=12))+
theme(legend.title.align=.5)+
theme(legend.text=element_text(size=10,face="bold"))
f
polsum
polsum<-politics%>%group_by(party,testtime)%>%arrange(party,testtime)%>%summarize(means=mean(optimismscore),sems=sd(optimismscore)/sqrt(length(optimismscore)))
politics<-read.csv("politics.csv")
polsum<-politics%>%group_by(party,testtime)%>%arrange(party,testtime)%>%summarize(means=mean(optimismscore),sems=sd(optimismscore)/sqrt(length(optimismscore)))
polsum
summary(aov(optimismscore~party*sex,data=pols[pols$testtime=="post",]))
temp<-pols[pols$testtime=="post",]%>%group_by(party,sex)%>%
summarize(means=mean(optimismscore),sems=sd(optimismscore)/sqrt(length(optimismscore)))
