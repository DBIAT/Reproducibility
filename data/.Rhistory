pols<-read.csv("politics.csv")
setwd("~/College/Spring2015/PSY 441 Projects in Experimental Psychology/Reproducibility")
pols<-read.csv("politics.csv")
setwd("~/College/Spring2015/PSY 441 Projects in Experimental Psychology/Reproducibility/data")
pols<-read.csv("politics.csv")
str(politics)
politics<-read.csv("politics.csv")
str(politics)
str(pol)
str(pols)
head(politics$subject[politics$testtime=="pre"]==politics$subject[politics$testtime=="post"])
trues<-politics$testtime=="pre"
sum(!(politics$subject[trues]==politics$subject[!trues]))
sum(!(politics$party[trues]==politics$party[!trues]))
sum(!(politics$subject[trues]==politics$subject[!trues]))
sum(!(politics$sex[trues]==politics$sex[!trues]))
sum(!(politics$income[trues]==politics$income[!trues]))
politics$subject<-factor(politics$subject)
politics$testtime<-factor(politics$testtime, levels=c("pre", "post"))
str(pols)
politics$subject<-factor(politics$subject)
str(pols)
politics$subject<-factor(politics$subject)
str(pols)
str(politics)
summary(pols$optimismscore[pols$testtime=="post"])
var(pols$optimismscore[pols$testtime=="post"])
hist(pols$optimismscore[pols$testtime=="post"])
tab<-table(pols$party[pols$testtime=="pre"],pols$sex[pols$testtime=="pre"])
tab
chisq.test(pols$party[pols$testtime=="pre"],pols$sex[pols$testtime=="pre"])
t.test(pols$income[pols$sex=="male" & pols$testtime=="pre"],pols$income[pols$sex=="female" & pols$testtime=="pre"])
library("dplyr")
temp<-pols[pols$testtime=="pre",]%>%group_by(sex)%>%summarize(means=mean(income),sems=sd(income)/sqrt(length(income)))
library("ggplot2")
f<-ggplot(temp,aes(x=factor(sex),y=means))+
geom_bar(stat="identity", color="black",fill=c("deeppink","deepskyblue2"))+
geom_errorbar(aes(ymax=means+sems, ymin=means-sems), width=.1)
f
f<-f+ggtitle("Incomes by Sex")+
labs(x="Sex", y="Incomes\n(higher=more income")+
scale_x_discrete(breaks=c("female","male"),labels=c("Female","Male"))+
theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))+
theme(panel.border=element_blank(), axis.line=element_line())+
theme(panel.grid.major.x=element_blank())+
theme(panel.grid.major.y=element_line(color="darkgrey"))+
theme(panel.grid.minor.y=element_blank())
f
summary(aov(optimismscore~party*sex,data=pols[pols$testtime=="post",]))
temp<-pols[pols$testtime=="post",]%>%group_by(party,sex)%>%
summarize(means=mean(optimismscore),sems=sd(optimismscore)/sqrt(length(optimismscore)))
library("gplots")
library("ggplot2")
col1=col2hex("deeppink")
col2=col2hex("deepskyblue2")
f<-ggplot(temp, aes(x=party, y=means, fill=sex))+
geom_bar(stat="identity",position=position_dodge())+
scale_fill_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))+
theme(legend.key=element_rect(color="black"))+
geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2,position=position_dodge(.9))+
ggtitle("Post-Test Optimism Scores by Sex and Political Affiliation")+
labs(x="Political Party Affiliation",y="Post-Test Optimism\n(Higher Value=Greater Optimism)")+
scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))+
theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))+
theme(panel.border=element_blank(),axis.line=element_line())+
theme(panel.grid.major.x=element_blank())+
theme(panel.grid.major.y=element_line(color="darkgrey"))+
theme(panel.grid.minor.y=element_blank())+
theme(legend.position=c(.2,.76))+
theme(legend.background=element_blank())+
theme(legend.background=element_rect(color="black"))+
theme(legend.title=element_blank())+
theme(legend.title=element_text(size=12))+
theme(legend.title.align=.5)+
theme(legend.text=element_text(size=10,face="bold"))
f
f<-ggplot(temp, aes(x=party, y=means, group=sex, color=sex))+
geom_line(size=1)+
geom_point(size=2)+
scale_color_manual(values=c(col1,col2),name="Sex",breaks=c("female","male"),labels=c("Female", "Male"))+
geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2)+
ggtitle("Post-test Optimism Scores by Sex and Political Affiliation")+
labs(x="Political Party Affiliation",y="Post-test Optimism\n(Higher Value=Greater Optimism)")+
scale_x_discrete(breaks=c("democrat","independent","republican"),labels=c("Democrat","Independent","Republican"))+
theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),max(temp$means)+2*max(temp$sems)))+
theme(panel.border=element_blank(),axis.line=element_line())+
theme(panel.grid.major.x=element_blank())+
theme(panel.grid.major.y=element_line(color="darkgrey"))+
theme(panel.grid.minor.y=element_blank())+
theme(legend.position=c(.2,.76))+
theme(legend.background=element_blank())+
theme(legend.background=element_rect(color="black"))+
theme(legend.title=element_blank())+
theme(legend.title=element_text(size=12))+
theme(legend.title.align=.5)+
theme(legend.text=element_text(size=10,face="bold"))
f
summary(aov(optimismscore~testtime*party+Error(subject/testtime),data=pols))
summary(aov(optimismscore~testtime*party+Error(subject/testtime),data=politics
))
summary(aov(optimismscore~testtime*party+Error(subject/testtime),data=politics))
summary(aov(optimismscore~testtime*sex+Error(subject/testtime),data=politics))
summary(aov(optimismscore~party*sex,data=pols[pols$testtime=="post",]))
summary(lm(optimismscore~[pols$testtime=="post",]+party,data=pols[pols$testtime=="post",]))
summary(lm(optimismscore~optimismscore [pols$testtime=="post",]+party,data=pols[pols$testtime=="post",]))
summary(lm(optimismscore~optimismscore+party,data=pols[pols$testtime=="post",]))
summary(lm(optimismscore~testtime+party,data=pols[pols$testtime=="post",]))
summary(lm(optimismscore~testtime[pols$testtime=="pre",]+party,data=pols[pols$testtime=="post",]))
summary(lm(optimismscore~optimismscore[pols$testtime=="pre",]+party,data=pols[pols$testtime=="post",]))
summary(lm(optimismscore~optimismscore$testtime=="pre"+party,data=pols[pols$testtime=="post",]))
summary(lm(optimismscore~optimismscore+party,data=pols[pols$testtime=="post",]))
